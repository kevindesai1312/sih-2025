import { createContext, useContext, useEffect, useMemo, useState } from "react";

export type Lang = "en" | "pa" | "hi";

export type Dictionary = Record<string, string>;

const dictionaries: Record<Lang, Dictionary> = {
  en: {
    appName: "SehatSetu",
    tagline: "Telemedicine for Rural India",
    nav_home: "Home",
    nav_features: "Features",
    nav_stakeholders: "Stakeholders",
    nav_architecture: "Architecture",
    nav_outcomes: "Outcomes",
    hero_title: "Multilingual telemedicine, offline records, and real‑time pharmacy stock",
    hero_sub: "Built for low bandwidth. Scalable across rural Punjab and beyond.",
    cta_assess: "Start symptom check",
    cta_records: "Save a health record",
    stats_connectivity: "Only 31% of rural Punjab has internet access",
    stats_growth: "Telemedicine adoption is growing at 31% CAGR (2020–2025)",
    features_title: "Key capabilities",
    f1_title: "Multilingual experience",
    f1_desc: "Punjabi, Hindi, and English UI with offline fonts and small bundles.",
    f2_title: "Offline digital health records",
    f2_desc: "Records stored locally and synced when online; export/import JSON.",
    f3_title: "Real‑time medicine availability",
    f3_desc: "Live pharmacy stock by pincode with lightweight polling.",
    f4_title: "AI symptom checker (low bandwidth)",
    f4_desc: "On‑device rules first; server triage only if needed.",
    stakeholders_title: "Stakeholders / Beneficiaries",
    architecture_title: "Technologies & Architecture",
    outcomes_title: "Expected outcomes",
    impact_title: "Impact & Why it matters",
    scalability_title: "Scalability & Innovation",
    problem_title: "Problem statement",
    problem_copy: "Limited connectivity and travel distances restrict access to quality care in rural Punjab. Patients lack longitudinal records and medicine availability is opaque, causing delays and higher costs.",
    impact_copy: "Provide reliable remote care despite low bandwidth, reduce travel, ensure medicine discoverability, and empower health staff with portable records.",
    outcomes_list: "Faster triage, reduced out‑of‑pocket costs, higher treatment adherence, and data to support population health programs.",
    stakeholders_list_patients: "Rural patients & families",
    stakeholders_list_staff: "Hospital & ASHA workers",
    stakeholders_list_dept: "Punjab Health Department",
    stakeholders_list_pharmacies: "Local pharmacies",
    stakeholders_list_farmers: "Farmers & migrant workers",
    records_title: "Your offline health records",
    records_name: "Patient name",
    records_age: "Age",
    records_notes: "Notes",
    records_save: "Save record",
    records_empty: "No records yet",
    records_export: "Export",
    records_import: "Import",
    records_status_online: "Online",
    records_status_offline: "Offline",
    symptom_title: "AI symptom checker (on‑device)",
    symptom_symptoms: "Select symptoms",
    symptom_other: "Other details",
    symptom_check: "Check now",
    symptom_result: "Result",
    pharmacy_title: "Medicine availability near you",
    pharmacy_pincode: "Pincode",
    pharmacy_check: "Check availability",
    pharmacy_updated: "Updated",
  },
  pa: {
    appName: "ਸਿਹਤਸੇਤੁ",
    tagline: "ਪਿੰਡਾਂ ਲਈ ਟੈਲੀਮੈਡੀਸਿਨ",
    nav_home: "ਘਰ",
    nav_features: "ਖਾਸੀਅਤਾਂ",
    nav_stakeholders: "ਹਿੱਸੇਦਾਰ",
    nav_architecture: "ਆਰਕੀਟੈਕਚਰ",
    nav_outcomes: "ਪਰਿਣਾਮ",
    hero_title: "ਬਹੁਭਾਸ਼ੀ ਟੈਲੀਮੈਡੀਸਿਨ, ਆਫ਼ਲਾਈਨ ਰਿਕਾਰਡ ਅਤੇ ਦਵਾਈਆਂ ਦੀ ਤਾਜ਼ਾ ਉਪਲਬਧਤਾ",
    hero_sub: "ਘੱਟ ਇੰਟਰਨੈੱਟ ਲਈ ਤਿਆਰ। ਪੰਜਾਬ ਦੇ ਪਿੰਡਾਂ ਵਿੱਚ ���ੈਲਣਯੋਗ।",
    cta_assess: "ਲੱਛਣ ਜਾਂਚੋ",
    cta_records: "ਰਿਕਾਰਡ ਸੰਭਾਲੋ",
    stats_connectivity: "ਪੰਜਾਬ ਦੇ ਪਿੰਡਾਂ ਵਿੱਚ ਕੇਵਲ 31% ਕੋਲ ਇੰਟਰਨੈੱਟ ਹੈ",
    stats_growth: "ਟੈਲੀਮੈਡੀਸਿਨ ਅਪਨਾਵਾ 31% CAGR ਨਾਲ ਵੱਧ ਰਿਹਾ ਹੈ (2020–2025)",
    features_title: "ਮੁੱਖ ਸਮਰੱਥਾਵਾਂ",
    f1_title: "ਬਹੁਭਾਸ਼ੀ ਅਨੁਭਵ",
    f1_desc: "ਪੰਜਾਬੀ, ਹਿੰਦੀ ਅਤੇ ਅੰਗਰੇਜ਼ੀ UI।",
    f2_title: "ਆਫ਼ਲਾਈਨ ਸਿਹਤ ਰਿਕਾਰਡ",
    f2_desc: "ਲੋਕਲ ਸਟੋਰੇਜ, ਆਨਲਾਈਨ ਹੋਣ ‘ਤੇ ਸਿੰਕ।",
    f3_title: "ਦਵਾਈ ਉਪਲਬਧਤਾ",
    f3_desc: "ਪਿੰਨਕੋਡ ਮੁਤਾਬਕ ਸਟਾਕ ਅਪਡੇਟ।",
    f4_title: "AI ਲੱਛਣ ਜਾਂਚ (ਘੱਟ ਡਾਟਾ)",
    f4_desc: "ਡਿਵਾਈਸ ‘ਤੇ ਨਿਯਮ; ਲੋੜ ਤੇ ਸਰਵਰ।",
    stakeholders_title: "ਹਿੱਸੇਦਾਰ / ਲਾਭਪਾਤਰੀ",
    architecture_title: "ਟੈਕਨਾਲੋਜੀ ਅਤੇ ਆਰਕੀਟੈਕਚਰ",
    outcomes_title: "���ਮੀਦ ਕੀਤੇ ਪਰਿਣਾਮ",
    impact_title: "ਅਸਰ ਅਤੇ ਕਿਉਂ",
    scalability_title: "ਸਕੇਲੈਬਿਲਟੀ ਅਤੇ ਨਵੀਨਤਾ",
    problem_title: "ਸਮੱਸਿਆ",
    problem_copy: "ਘੱਟ ਕਨੈਕਟਿਵਿਟੀ ਅਤੇ ਦੂਰੀ ਕਾਰਨ ਗੁਣਵੱਤਾ ਵਾਲੀ ਦੇਖਭਾਲ ਤੱਕ ਪਹੁੰਚ ਘੱਟ ਹੈ। ਰਿਕਾਰਡ ਨਹੀਂ, ਦਵਾਈ ਉਪਲਬਧਤਾ ਅਸਪਸ਼ਟ ਹੈ।",
    impact_copy: "ਘੱਟ ਡਾਟਾ ‘ਚ ਭਰੋਸੇਯੋਗ ਸੇਵਾ, ਯਾਤਰਾ ਘਟੇ, ਦਵਾਈ ਮਿਲੇ, ਸਟਾਫ਼ ਸਸ਼ਕਤ ਹੋਵੇ।",
    outcomes_list: "ਤੇਜ਼ ਟ੍ਰਾਇਆਜ, ਘੱਟ ਖ਼ਰਚ, ਵੱਧ ਅਨੁਸਰਣ, ਜਨਸਿਹਤ ਲਈ ਡਾਟਾ।",
    stakeholders_list_patients: "ਮਰੀਜ਼",
    stakeholders_list_staff: "ਹਸਪਤਾਲ/ਆਸ਼ਾ ਵਰਕਰ",
    stakeholders_list_dept: "ਪੰਜਾਬ ਹੈਲਥ ਡਿਪਾਰਟਮੈਂਟ",
    stakeholders_list_pharmacies: "ਸਥਾਨਕ ਕੇਮੀਸਟ",
    stakeholders_list_farmers: "ਕਿਸਾਨ",
    records_title: "ਤੁਹਾਡੇ ਆਫ਼ਲਾਈਨ ਰਿਕਾਰਡ",
    records_name: "ਨਾਮ",
    records_age: "ਉਮਰ",
    records_notes: "ਨੋਟਸ",
    records_save: "ਸੇਵ ਕਰੋ",
    records_empty: "ਕੋਈ ਰਿਕਾਰਡ ਨਹੀਂ",
    records_export: "ਐਕਸਪੋਰਟ",
    records_import: "ਇੰਪੋਰਟ",
    records_status_online: "ਆਨਲਾਈਨ",
    records_status_offline: "ਆਫ਼ਲਾਈਨ",
    symptom_title: "AI ਲੱਛਣ ਜਾਂਚ (ਡਿਵਾਈਸ ‘ਤੇ)",
    symptom_symptoms: "ਲੱਛਣ ਚੁਣੋ",
    symptom_other: "ਹੋਰ ਵੇਰਵਾ",
    symptom_check: "ਜਾਂਚੋ",
    symptom_result: "ਨਤੀਜਾ",
    pharmacy_title: "ਨਜ਼ਦੀਕੀ ਦਵਾਈ ਉਪਲਬਧਤਾ",
    pharmacy_pincode: "ਪਿੰਨਕੋਡ",
    pharmacy_check: "ਚੈਕ ਕਰੋ",
    pharmacy_updated: "ਅਪਡੇਟ",
  },
  hi: {
    appName: "सेहतसेतु",
    tagline: "ग्रामीण भारत के लिए टेलीमेडिसिन",
    nav_home: "होम",
    nav_features: "फीचर्स",
    nav_stakeholders: "हितधारक",
    nav_architecture: "आर्किटेक्चर",
    nav_outcomes: "परिणाम",
    hero_title: "बहुभाषी टेलीमे���िसिन, ऑफ़लाइन रिकॉर्ड और दवा उपलब्धता",
    hero_sub: "कम इंटरनेट के लिए अनुकूलित। पंजाब के ग्रामीण क्षेत्रों में स्केलेबल।",
    cta_assess: "लक्षण जाँचें",
    cta_records: "रिकॉर्ड सहेजें",
    stats_connectivity: "पंजाब के ग्रामीण इलाकों में केवल 31% के पास इंटरनेट है",
    stats_growth: "टेलीमेडिसिन 31% CAGR (2020–2025) से बढ़ रहा है",
    features_title: "मुख्य क्षमताएँ",
    f1_title: "बहुभाषी",
    f1_desc: "पंजाबी, हिंदी और अंग्रेज़ी UI।",
    f2_title: "ऑफ़लाइन स्वास्थ्य रिकॉर्ड",
    f2_desc: "लोकल स्टोरेज, ऑनलाइन होने पर सिंक।",
    f3_title: "दवा उपलब्धता",
    f3_desc: "पिनकोड के अनुसार स्टॉक अपडेट।",
    f4_title: "AI लक्षण चेकर (कम डेटा)",
    f4_desc: "डिवाइस पर नियम; ज़रूरत पर सर्वर।",
    stakeholders_title: "हितधारक / लाभार्थी",
    architecture_title: "टेक्नोलॉजी और आर्किटेक्चर",
    outcomes_title: "अपेक्षित परिणाम",
    impact_title: "प्रभाव और क्यों",
    scalability_title: "स्केलेबिलिटी और नवाचार",
    problem_title: "समस्या विवरण",
    problem_copy: "कम कनेक्टिविटी और दूरी के कारण गुणवत्तापूर्ण इलाज तक पहुँच सीमित है। रिकॉर्ड नहीं, दवा उपलब्धता अस्पष्ट।",
    impact_copy: "कम डेटा में विश्वसनीय सेवा, यात्रा कम, दवा मिलना आसान, स्टाफ सशक्त।",
    outcomes_list: "तेज़ ट्राइएज, कम खर्च, बेहतर पालन, जनस्वास्थ्य के लिए डेटा।",
    stakeholders_list_patients: "मरीज",
    stakeholders_list_staff: "हॉस्पिटल/आशा कार्यकर्ता",
    stakeholders_list_dept: "पंजाब स्वास्थ्य विभाग",
    stakeholders_list_pharmacies: "स्थानीय फार्मेसी",
    stakeholders_list_farmers: "किसान",
    records_title: "आपके ऑफ़लाइन रिकॉर्ड",
    records_name: "नाम",
    records_age: "आयु",
    records_notes: "नोट्स",
    records_save: "सेव करें",
    records_empty: "कोई रिकॉर्ड नहीं",
    records_export: "एक्सपोर्ट",
    records_import: "इम्पोर्ट",
    records_status_online: "ऑनलाइन",
    records_status_offline: "ऑफ़लाइन",
    symptom_title: "AI लक्षण चेकर (डिवाइस पर)",
    symptom_symptoms: "लक्षण चुनें",
    symptom_other: "अन्य विवरण",
    symptom_check: "जाँचें",
    symptom_result: "परिणाम",
    pharmacy_title: "आपके पास दवा उपलब्धता",
    pharmacy_pincode: "पिनकोड",
    pharmacy_check: "जाँचें",
    pharmacy_updated: "अद्यतन",
  },
};

const I18nContext = createContext<{ lang: Lang; setLang: (l: Lang) => void; t: (key: string) => string } | null>(null);

export function I18nProvider({ children }: { children: React.ReactNode }) {
  const [lang, setLang] = useState<Lang>(() => (localStorage.getItem("lang") as Lang) || "en");
  useEffect(() => {
    localStorage.setItem("lang", lang);
    const html = document.documentElement;
    html.lang = lang;
  }, [lang]);
  const t = useMemo(() => {
    const dict = dictionaries[lang];
    return (key: string) => dict[key] ?? key;
  }, [lang]);
  return <I18nContext.Provider value={{ lang, setLang, t }}>{children}</I18nContext.Provider>;
}

export function useI18n() {
  const ctx = useContext(I18nContext);
  if (!ctx) throw new Error("useI18n must be used within I18nProvider");
  return ctx;
}